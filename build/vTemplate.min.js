/*
 *@name     vTemplate
 *@version  v0.1.0
 *@desc     An Easy Javascript Template.
 *@author   VeeQun
 *@license  MIT
 *@modified 2014-05-07
 */
!function(Global){function vTemplate(tpl){var that={},info={tpl:tpl};return that.compile=function(){if("function"!=typeof that.render){var tpl=info.tpl.replace(/(\"|\')/gm,"\\$1"),evalString='that.render=function(data) {var out="";'+__compile__(tpl)+";return out;}";eval(evalString)}},that}function __compile__(stpl,config){var stplReg=consts.stplReg;stplReg.lastIndex=0;for(var step=null,oldIndex=0,compiled="",ignored=config&&config.ignored||[];step=stplReg.exec(stpl);)if(compiled+=prefix.str+stpl.slice(oldIndex,stplReg.lastIndex-step[0].length)+postfix.str,oldIndex=stplReg.lastIndex,"="==step[1]){step[2]=step[2].replace(/\\\"/gm,'"');var kw=step[2].split(".")[0];compiled+=(inArray(ignored,kw)?prefix.arrKw:prefix.attr)+step[2]+postfix.semicolon}else if("@"==step[3]){var subStpl=stpl.slice(oldIndex+1),startFlag="<@"+step[4]+"(",endFlag="</@"+step[4]+">",map=checkoutMap(startFlag,endFlag,subStpl);if(!map)throw"Something wrong with your template";var mapStpl=map[1],match=step[0],args=match.slice(match.indexOf("(")+1,match.indexOf(")")).replace(/(\w+(\.\w+)*)/gm,'"$1"');eval("compiled+=helpers."+step[4]+"("+args+",mapStpl,ignored)"),stplReg.lastIndex=oldIndex=oldIndex+map[0]+1}var tail=prefix.str+stpl.slice(oldIndex)+postfix.str;return compiled+tail}function inArray(a,b){if("indexOf"in a)return-1!==a.indexOf(b);for(var c=a.length;c;)if(a[--c]==b)return!0;return!1}function checkoutMap(a,b,c){for(var d,e,f=0,g=(a.length,b.length),h=c;-1!=(e=h.indexOf(b));){if(d=h.slice(0,e),f+=e+g,-1==d.indexOf(a))return[f,c.slice(0,f-g)];h=h.slice(e+g)}return!1}var consts={stplReg:/\<(\=)([^\<\=\>]+?)\>|\<(\@)([^\<\@\=]+?)\(\s*(?:\w+(?:\.\w+)*)(?:\s*\,\s*(?:\w+(?:\.\w+)*)){0,}\s*\)/gm,arrPush:Array.prototype.push,keywords:["alert","break","case","catch","continue","debugger","default","default","delete","do","eval","else","finally","for","function","if","in","instanceof","new","return","switch","this","throw","try","typeof","var","void","while","with","Object","prototype","Array","Number","String","Boolean","Null","Undefined","RegExp","Function","window","console","arguments","setTimeout","setInterval","clearTimeout","clearInterval"]},prefix={str:"out+='",arrKw:"out+=",attr:"out+=data."},postfix={str:"';",semicolon:";"},helpers={count:0,prefix:"data.",each:function(a,b,c,d,e){{var f="k"+helpers.count,g="curr"+helpers.count;"len"+helpers.count++}if(!c||!d){var h=!0;d=b}var i=h?[]:[b,c];consts.arrPush.apply(i,e);var j=__compile__(d,{ignored:i}),k=(inArray(i,a)?"":"data.")+a,l="for(var "+f+"=0,"+g+"="+k+",len="+g+".length;"+f+"<len;"+f+"++){"+(h?"":"var "+b+"="+f+","+c+"="+g+"["+f+"];")+j+"}";return l},"if":function(a,b,c){var d=[];consts.arrPush.apply(d,c),consts.arrPush.apply(d,consts.keywords);var e=/(\w+)(\.\w+)*/gm;a=a.replace(e,function(a,b){return console.log(a),inArray(d,b)?void 0:helpers.prefix+a});var f=__compile__(b,{ignored:c}),g="if("+a+"){"+f+"}";return g}};Global.vTemplate=vTemplate}(this);